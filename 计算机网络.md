# 网络体系结构

[TOC]



## OSI七层模型和TCP/IP模型

| OSI        | TCP/IP     |
| ---------- | :--------- |
| 应用层     |            |
| 表示层     | 应用层     |
| 会话层     |            |
| 传输层     | 传输层     |
| 网络层     | 网络层     |
| 数据链路层 |            |
| 物理层     | 网络接口层 |

> 物理层：传输比特流。
>
> 传输介质有光纤、 同轴电缆、双绞线等

> 数据链路层：在不可靠的物理介质上提供可靠的传输（封装成帧、差错控制、流量控制、传输管理）
>
> 协议：CSMA/CD、PPP、HDLC、

> 网络层：为主机提供数据传输服务（流量控制、拥塞控制、差错控制、网际互联）
>
> 协议：IP、ARP、ICMP、RIP、OSPF、BGP

> 传输层：为进程提供通用数据传输服务。
>
> 协议：TCP、UDP

> 应用层：为特定应用程序提供数据传输服务。
>
> 协议：HTTP、HTTPS、DNS、SMTP、FTP、SSH、TELNET、SNMP

**表示层** ：数据压缩、加密以及数据描述。**会话层** ：建立及管理会话。

# 网络协议常见问题

## CSMA/CD（数据链路）

**载波侦听多路访问/冲突检测**，（书上有流程图）记住工作原理和步骤。

**PPP：**点到点链路上传输数据报，采用字节填充方式，支持全双工链路。

**HDLC**：实现远程用户间资源共享以及信息交互，采用比特流，信息帧、监督帧和无信号帧。



## IP、ARP、ICMP（网络层）

IP：internet协议，实现网络互连，传送数据包

ARP：地址解析协议，将IP地址解析成MAC地址，使得交换机能通过MAC地址通信。

ICMP：ip网络中控制消息，反馈网络中出现的问题，ping 命令用的就是icmp协议，检查网络连通性



## TCP和UDP的区别（传输层）

TCP：传输控制协议

UDP：用户数据报协议

区别：

1.TCP基于面向连接，UDP无连接（可靠的字节流服务，不提供可靠性）

2.流模式和数据报模式

3.TCP保证数据顺序性，UDP不保证

4.TCP全双工，UDP一对一、一对多

5.如浏览器中访问网页传输数据使用的是TCP，需要保证数据的准确性、顺序性，但开销较大，将页面拆分成几个部分打上序号分开传输，收到数据后再根据序号拼起来。

6.UDP是无连接的数据报模式，开销成本小，传输快，不保证可靠性，大多用来传输视频，流媒体、直播、进行游戏等对数据完整性要求不是那么高的。



## TCP三次握手四次挥手

**三次挥手只说原理：**

1.客户端向服务端发送一个请求报文

2.服务端收到请求，同意连接，向客户端发送一个确认报文

3.客户端收到确认报文，在向服务端发送确认报文。然后建立连接可以发送数据。

**说细节：**

1.客户端发送一个**标志位**SYN=1和**起始序号**seq=x

2.服务端**标志位**SYN=1和**确认标志位**ACK=1，**确认号码**ack=x+1(客户端起始序号x+1)，并也有**起始序号**seq=y

3.客户端**确认标志位**ACK=1，**序号**seq=x+1和**确认号码**位ack=y+1(服务端起始序号y+1)

**标志位总结：**

1、SYN = 1, seq = x 。 

2、SYN= 1, ACK= 1, seq= y, ack = x + 1 。 

3、ACK= 1, seq= x + 1, ack = y + l 。



**四次挥手只说原理**

1.客户端向服务端发送关闭请求

2.服务端收到关闭请求，发送确认报文

3.服务端没有发送的数据，发送关闭请求

4.客户端收到关闭请求，必须发送请求。

**说细节：**

1.客户端发送**结束标志位**FIN=1和**起始序号**seq=u

2.服务端发送**确认标志位**和**确认号码**ack=u+1（客服端起始序号u+1），加上**起始序号**seq=u

3.服务端发送**结束标志位**FIN=1、**确认标志位**ACK=1和**确认号码**ack=u+1，加上**起始序号**seq=w

4.客服端发送**确认标志位**，**序号**seq=u+1和**确认号码**ack=w+1（服务端发送结束的起始序号）

**标志位总结：**

1、FIN= 1, seq =u 。 

2、ACK = 1, seq = v, ack = u + 1 。 

3、FIN= 1, ACK= 1, seq= w, ack = u + 1 。 

4、ACK= 1, seq= u + 1, ack = w + 1。



## 为什么三次握手四次挥手？

因为当客户端发送关闭连接请求时，仅代表客户端结束发送数据。此时服务端如果仍有数据需要发送，那么此时只能先发送一个确认请求，而不能立即发送关闭连接请求，直到服务端数据传输完毕，再发出关闭连接请求，所以是四次挥手。